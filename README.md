# KLEEによる迷路プログラム分析

## 概要
Kleeを用いて迷路プログラムを分析するサンプルプロジェクトです。
Kleeの使用例として、以下のサンプルプログラム・スクリプトを提供します。
- 迷路プログラム
- テストケースのカバレッジを確認するスクリプト
- 迷路の解法を解析するスクリプト


## 迷路プログラム
`maze.c`は7×11の簡単な迷路プログラムです。
標準入力から入力を受け付け、ユーザはゴール（#）を目指します。
途中で壁（-, |, +）にあたった場合、もしくは、規定回数（28回）以内にゴールできない場合は失敗とみなします。


## テストケースのカバレッジを確認するスクリプト
`coverage_test.sh`ではKleeによって生成されたプログラムの網羅性を検証します。
具体的には下記の処理によって網羅性を検証します。
1. 迷路プログラムを`gcov`（実行済みのパスを記録するオプション）付きでコンパイル
2. 迷路プログラムをLLVM IR（中間表現）に変換
3. 2で生成したLLVM IRを入力とし、Kleeを用いてテストケースを生成
4. 1で生成した実行ファイルにおける実行済みパスを出力する
5. 1で生成した実行ファイルを3で生成したテストケースを入力として実行する
6. 1で生成した実行ファイルにおける実行済みパスを出力する


## 迷路の解法を解析するスクリプト
`assertion_test.sh`ではKleeを用いて迷路を解く入力値を解析します。
具体的には下記の方法で入力値を探索します
- 迷路プログラムにおいて、成功した際に到達する箇所に`klee_assert(0)`を挿入
- `klee_assert`はKleeを実行する際に引数が偽となるケースをエラーとしてログを出力する機能（本来は起こり得ない振る舞いを検知するための仕組み）
- 迷路プログラムからLLVM IRを作成しKleeを実行する
- エラーとしてログが出力されているテストケースが、迷路プログラムを解く入力値となる


## 参考情報
- https://feliam.wordpress.com/2010/10/07/the-symbolic-maze/


